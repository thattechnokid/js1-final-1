var completedList=document.querySelector("#completed-tasks"),incompleteList=document.querySelector("#incomplete-tasks"),taskInput=document.querySelector("#new-input"),editPopup=document.querySelector(".edit-popup"),editToDo=document.querySelector(".list-edit"),addButton=document.querySelector(".add-button"),editTodoForm=document.forms.editToDo,completedTaskArray=[],incompleteTaskArray=[],completedTaskStorage=localStorage.getItem("completedTaskArray"),incompleteTaskStorage=localStorage.getItem("incompleteTaskArray"),incompleteParsedArray=JSON.parse(incompleteTaskStorage)||[],completedParsedArray=JSON.parse(completedTaskStorage)||[];function TodoItem(text){this.li=document.createElement("li"),this.li.textContent=text,this.checkbox=document.createElement("i"),this.checked=document.createElement("i"),this.editButton=document.createElement("i"),this.deleteButton=document.createElement("i"),this.checkbox.classList.add("fa","fa-circle-o"),this.checked.classList.add("fa","fa-check-circle","hidden"),this.editButton.classList.add("fa","fa-pencil-square-o"),this.deleteButton.classList.add("fa","fa-times-circle"),this.checkbox.setAttribute("onclick","void(0)"),this.checked.setAttribute("onclick","void(0)"),this.editButton.setAttribute("onclick","void(0)"),this.deleteButton.setAttribute("onclick","void(0)"),this.li.append(this.checkbox,this.checked,this.editButton,this.deleteButton),this.strikeThrough=function(){this.li.classList.add("strike-through"),this.checked.classList.remove("hidden"),this.checkbox.classList.add("hidden"),this.editButton.classList.add("hidden")}}window.onbeforeunload=function(){localStorage.setItem("completedTaskArray",JSON.stringify(completedTaskArray)),localStorage.setItem("incompleteTaskArray",JSON.stringify(incompleteTaskArray))};var inputtedText=function(){addButton.addEventListener("click",function(){var inputText=taskInput.value;if(inputText.length>0){incompleteTaskArray.push(inputText);var createTaskElement=new TodoItem(inputText);createTaskElement.li.classList.add("special-styles"),incompleteList.append(createTaskElement.li),taskInput.value=""}})},checkOffThisTask=function(whichItem){removeFromArray(incompleteTaskArray,whichItem.textContent),incompleteList.removeChild(whichItem),completedTaskArray.push(whichItem.textContent);var completedTasks=new TodoItem(whichItem.textContent);completedTasks.strikeThrough(),completedTasks.li.classList.add("special-styles"),completedList.append(completedTasks.li)},uncheckOffThisTask=function(whichItem){removeFromArray(completedTaskArray,whichItem.textContent),completedList.removeChild(whichItem),incompleteTaskArray.unshift(whichItem.textContent);var incompletedTasks=new TodoItem(whichItem.textContent);incompletedTasks.li.classList.add("special-styles"),incompleteList.insertBefore(incompletedTasks.li,incompleteList.firstChild)},removeFromArray=function(arrayToRemoveFrom,whatToRemove){for(var i=0;i<arrayToRemoveFrom.length;i++)arrayToRemoveFrom[i]===whatToRemove&&arrayToRemoveFrom.splice(i,1)},deleteThisTask=function(whichItem){if(1==confirm("Are you sure you want to delete this task?")){whichItem.textContent;whichItem.parentElement===incompleteList?(incompleteList.removeChild(whichItem),removeFromArray(incompleteTaskArray,whichItem.textContent)):whichItem.parentElement===completedList&&(completedList.removeChild(whichItem),removeFromArray(completedTaskArray,whichItem.textContent))}},editThisTask=function(whichItem){editToDo.value=whichItem.textContent,editPopup.classList.remove("hidden"),editTodoForm.save.addEventListener("click",function(e){saveEdits(e)}),document.addEventListener("keypress",function(e){saveEdits(e)});var saveEdits=function(e){if(e.target===editTodoForm.save||13===e.keyCode){if(e.preventDefault(),0===editToDo.value.length)editPopup.classList.add("hidden");else{var editedTodoText=editToDo.value,replacingTask=new TodoItem(editedTodoText);replacingTask.li.classList.add("special-styles"),editPopup.classList.add("hidden");for(var i=0;i<=incompleteTaskArray.length;i++)incompleteTaskArray[i]===whichItem.textContent&&incompleteTaskArray.splice(i,1,editedTodoText);incompleteList.replaceChild(replacingTask.li,whichItem),editToDo.value=""}editTodoForm.save.removeEventListener("click",function(e){saveEdits(e)}),document.removeEventListener("keypress",function(e){saveEdits(e)})}}},actionButtonListeners=function(){document.addEventListener("click",function(event){var whichItem=event.target.parentElement;switch(event.target.classList[1]){case"fa-circle-o":checkOffThisTask(whichItem);break;case"fa-check-circle":uncheckOffThisTask(whichItem);break;case"fa-pencil-square-o":editThisTask(whichItem);break;case"fa-times-circle":deleteThisTask(whichItem)}})},loadLocalStorage=function(whichArray){for(var i=0;i<whichArray.length;i++)if(void 0!==whichArray[i]&&null!==whichArray[i]){var storedList=new TodoItem(whichArray[i]);whichArray===incompleteParsedArray?(incompleteTaskArray.push(whichArray[i]),storedList.li.classList.add("special-styles"),incompleteList.append(storedList.li)):(completedTaskArray.push(whichArray[i]),storedList.strikeThrough(),storedList.li.classList.add("special-styles"),completedList.append(storedList.li))}};inputtedText(),loadLocalStorage(incompleteParsedArray),loadLocalStorage(completedParsedArray),actionButtonListeners();